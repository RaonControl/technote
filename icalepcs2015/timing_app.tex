\documentclass[a4paper,
               %boxit,
               %titlepage,   % separate title page
               %refpage      % separate references
              ]{jacow}

\makeatletter%                           % test for XeTeX where the sequence is by default eps-> pdf, jpg, png, pdf, ...
\ifboolexpr{bool{xetex}}                 % and the JACoW template provides JACpic2v3.eps and JACpic2v3.jpg which might generates errors
 {\renewcommand{\Gin@extensions}{.pdf,%
                    .png,.jpg,.bmp,.pict,.tif,.psd,.mac,.sga,.tga,.gif,%
                    .eps,.ps,%
                    }}{}
\makeatother

\ifboolexpr{bool{xetex} or bool{luatex}} % test for XeTeX/LuaTeX
 {}                                      % input encoding is utf8 by default
 {\usepackage[utf8]{inputenc}}           % switch to utf8

\usepackage[USenglish]{babel}
%\usepackage{control}
\RequirePackage{kotex}



\ifboolexpr{bool{jacowbiblatex}}%        % if BibLaTeX is used
 {%
  \addbibresource{jacow-test.bib}
  \addbibresource{biblatex-examples.bib}
 }{}

\newcommand\SEC[1]{\textbf{\uppercase{#1}}}

%%
%%   Lengths for the spaces in the title
%%   \setlength\titleblockstartskip{..}  %before title, default 3pt
%%   \setlength\titleblockmiddleskip{..} %between title + author, default 1em
%%   \setlength\titleblockendskip{..}    %afterauthor, default 1em

%\copyrightspace %default 1cm. arbitrary size with e.g. \copyrightspace[2cm]

% testing to fill the copyright space
%\usepackage{eso-pic}
%\AddToShipoutPictureFG*{\AtTextLowerLeft{\textcolor{red}{COPYRIGHTSPACE}}}

\begin{document}


\title{Application using timing system of RAON accelerator\thanks{Work supported by ...}}

\author{S. Lee\thanks{silee7103@ibs.re.kr}, CW. Son\thanks{scwook@ibs.re.kr}, HJ. Jang\thanks{lkcom@ibs.re.kr}, IBS, Daejeon, South Korea\\
       }
\maketitle

%
\begin{abstract}
   RAON is a particle accelerator to research the interaction between the nucleus forming a rare isotope as Korean heavy-ion accelerator. RAON accelerator consists of a number of facilities and equipments as a large-scaled experimental device operating under the distributed environment. For synchronization control between these experimental devices, timing system of the RAON uses the VME-based EVG/EVR system. This paper is intended to test high-speed device control with timing event signal. To test the high-speed performance of the control logic with the minimized event signal delay, we are planing to establish the step motor controller testbed applying the FPGA chip. The testbed controller will be configured with Zynq 7000 series of Xilinx FPGA chip. Zynq as SoC (System on Chip) is divided into PS (Processing System) with PL (Programmable Logic). PS with the dual-core ARM cpu is performing the high-level control logic at run-time on linux operating system. PL with the low-level FPGA I/O signal interfaces with the step motor controller directly with the event signal received from timing system.
   
   This paper describes the content and performance evaluation obtaining from the step motor control through the various synchronized event signal received from the timing system.
\end{abstract}


\section{Introduction}
The RAON is a new heavy ion accelerator under construction in South Korea, which is to produce a variety of stable ion and rare isotope beams to support various researches for the basic science and applied research applications.\cite{TSHOO:NIMB} To produce the isotopes to fulfill the requirements we have planed the several modes of operation scheme which require fine-tuned synchronous controls, asynchronous controls, or both among the accelerator complexes. RAON, which is a large experimental facility, consists of many experimental devices and additional facilities. For synchronized control under the distributed environment, timing system of the RAON uses the VME-based EVG/EVR system.

\section{Timing System}
The timing system uses the Event Generator(EVG)/Event Receiver (EVR)\cite{mrf} system of the Micro-Research Finland Oy company and VME form factor. The timing system consists of an EVG which converts timing events and signals to an optical signal distributed through Fan-Out units to an array of EVRs. The EVRs decode the optical signal and produce hardware and software output signals based on the timing events. The VME controller installed in VME crate uses MVME6100 or 3100 of Emerson company. The VME controllers use real-time operating system, VxWorks 6.9 for a fast response. Those controllers control FPGA-based EVG/EVR boards using mfrioc2 of EPICS IOCs on VxWorks.
\hfil\break
The characteristics of MRF timing system are :
\begin{Itemize}
	\item Event driven system, 256 event codes
	\item Event generation using external RF reference clock
	\item 50 $\sim$  125MHz event clock rate
	\item Events generated
	\begin{Itemize}
		\item From external HW inputs
		\item Two sequencers (up to 2048 events/sequencer)
		\item Multi counters
	\end{Itemize}
	\item Cascaded Event Generators
	\item Different Clock Synchronization
\end{Itemize}

\subsection{Hardware Configuration}

Hardware of the timing module consist of:

\begin{Itemize}
	\item XLI GPS Time System
	\item Rubidium Frequency Standard Clock Source (FS725)
	\item Event Trigger System \\
	(Event Generator/Receiver,Fanout/Concentrator)
	\item MVME 6100/MVME 3100 controller board 
	\item VME Crate (Wiener)
	\item SMA 100a RF Signal Generator
\end{Itemize}
\hfil\break
Fig.~\ref{timing:rack} shows hardware configuration of the test timing system. 
\begin{figure}[!htb]
	\centering
	\includegraphics*[width=65mm]{timing_rack}
	\caption{Timing Hardware configuration }
	\label{timing:rack}
\end{figure}

Referring to the configuration of Fig.~\ref{timing:rack}, GPS receiver synchronizes with rubidium clock and EVG to 1PPS. Signal generator generates RAON reference clock(81.25 MHz, RF master oscillator) to EVG. The two signals of EVG are synchronized by locking the phase. The synchronized signal of EVG is generated and distributed to EVR according to event code of MRFIOC on VME system.

\subsection{Software Configuration}
Software to operate the timing system consist of:
\begin{Itemize}
	\item Workbench 3.3, vxWorks IDE
	\item vxWorks 6.9 Realtime Operating System
	\item EPICS framework (R3.14.12.5)
	\item MRFIOC2/SRSIOC 
	\item Network Time Protocol (NTP)
\end{Itemize}

\section{Fast Stepper Motor Testbed using timing signal}
Configuration of Fig.~\ref{stepper} shows the overall of a fast stepper motor testbed operating by the input of the timing signal. The EVG of the timing system receives two input signals, GPS and RF reference clock. The two signals of EVG are synchronized by locking phase. EPICS software module, mrfioc2, on real-time OS (vxWorks) of VME controller registers event codes. The synchronized events of EVG are distributed through optical fiber links to EVGs.The EVRs received some events from EVG decode those events and trigger TTL level signals to ZC706 evaluation board. The PL of zynq which is received from external TTL signal triggers signal to motor controller according to the configured motor's operation parameters. The setting of the parameter values for the motor control is performed on the EPICS interface of the zynq PS. PS is equipped with the EPICS software module on the cross-compiled linux OS of the ARM processor. The interface between PS and PL uses the AXI interface of AMBA. The ARM Advanced Microcontroller Bus Architecture (AMBA)\cite{amba-bus} is an open-standard, on-chip interconnect specification for the connection and management of functional blocks in system-on-a-chip (SoC) designs. It should be also developed the linux device driver for the AXI interface between both area. The types of motor which can be supported to low voltage drive board of the Analog Device\cite{analog} are brushless DC, PMSM, brushed DC or stepper motor. 

\subsection{System on Chip: FPGA - Zynq}
Zynq\cite{xilix,zynq} as SoC is divided into Processing System (PS,dual-core ARM cpu) with  Programmable Logic (PL, FPGA). Communication between PS and PL is through the AXI interface of ABMA.

\subsection{ZC706 Evaluation Board of Xilinx}
The ZC706 evaluation board for All Programmable SoC (AP SoC) provides a hardware environment for developing and evaluating designs targeting the ZynqÂ®-7000 AP SoC.\cite{zc706-doc} The ZC706 board has the SMA port which is the programmable user clock for the TTL out signal of the EVR timing board.

\subsection{Linux on Zynq PS (ARM processor)}
To operate linux OS on the ARM processor of the zynq PS there consists of:
\begin{Itemize}
	\item ARM Cross Compile Tool Chain (arm-linux-gnueabihf)
	\item Linux Kernel Source (Ubuntu-based Linaro)
	\item Bootloader (BOOT.BIN: FSBL.elf, U-Boot.elf, Zynq.bif, FPGA Bitstrem)
	\item Board Support Package (Linux Device Tree)
	\item Root File System (Busybox)
\end{Itemize}
Linaro is a not-for-profit engineering organization that works on free and open-source software such as the Linux kernel, the GNU Compiler Collection (GCC), power management, graphics and multimedia interfaces for the ARM family of instruction sets and implementations thereof as well as for the Heterogeneous System Architecture.\cite{linaro}   
The linaro kernel source is the ubuntu-based kernel source including a lot of device driver such as zynq device tree.


\subsection{Linux Device Driver}

\subsection{Controller for Motor Drive}

\subsection{Interface}
\subsubsection{FPGA Interface}
\subsubsection{EPICS Interface} 

The title should use \SI{14}{pt} bold uppercase letters and be centered on the page.
Individual letters may be lowercase to avoid misinterpretation (e.g., mW, MW).
To include a funding support statement, put an asterisk after the title and
the support text at the bottom of the first column on page~1---in Word,
use a text box; in \LaTeX, use $\backslash$\texttt{thanks}.


\begin{figure*}[!tbh]
    \centering
    \includegraphics*[width=\textwidth,height=0.7\textwidth]{motor-testbed}
    \caption{Fast motor testbed adopted zynq device using timing event signal}
    \label{stepper}
\end{figure*}


\section{Summary}

Table~\ref{app-conf} summarizes the fonts and spacings used in the styles of
a JACoW template (these are implemented in the \LaTeX\ class file).
\begin{table}[h!t]
    \setlength\tabcolsep{3.8pt}
    \caption{Configuration of Application using Timing Signal}
    \label{app-conf}
    \begin{tabular}{@{}llcc@{}}
        \toprule
        \textbf{Style} & \textbf{Font}               & \textbf{Space}  & \textbf{Space} \\
                       &                             & \textbf{Before} & \textbf{After} \\
        \midrule
                       & \SI{14}{pt}                 & \SI{0}{pt}      & \SI{3}{pt}  \\
          Paper Title  & Upper case except for       &                 &      \\
                       & required lower case letters &                 &      \\   %corrected 080515 vrws requred
                       & Bold                        &                 &      \\
         \midrule
          Author list  & \SI{12}{pt}                 & \SI{9}{pt}      & \SI{12}{pt} \\
                       & Upper and Lower case        &                 &      \\
         \midrule
         Section       & \SI{12}{pt}                 & \SI{9}{pt}      & \SI{3}{pt}  \\
         Heading       & Uppercase                   &                 &      \\
                       & bold                        &                 &      \\
        \midrule
         Subsection    & \SI{12}{pt}                 & \SI{6}{pt}      & \SI{3}{pt}  \\
         Heading       & Initial Caps                &                 &      \\
                       & Italic                      &                 &      \\
        \midrule
         Third-level   & \SI{10}{pt}                 & \SI{6}{pt}           & \SI{0}{pt}  \\
         Heading       & Initial Caps                &                 &      \\
                       & Bold                        &                 &      \\
        \midrule
         Figure        & \SI{10}{pt}                 & \SI{3}{pt}           & \SI{6}{pt}  \\
         Captions      &                             &                 &      \\
        \midrule
         Table         & \SI{10}{pt}                      & \SI{3}{pt}           & \SI{3}{pt}  \\
         Captions      &                             &                 &      \\
        \midrule
         Equations     & \SI{10}{pt} base font            & \SI{12}{pt}          & \SI{12}{pt} \\
        \midrule
         References    & \SI{9/10}{pt}, justified with  \SI{0.25}{in} &      &  \\
                       & hanging indent, reference   & $\ge$\SI{0}{pt} & $\ge$\SI{0}{pt}  \\
                       & number right aligned     &                 &        \\
        \bottomrule
    \end{tabular}
\end{table}

\section{Conclusion}
Any conclusions should be in a separate section directly preceding
the \SEC{Acknowledgment}, \SEC{Appendix}, or \SEC{References} sections, in that
order.

\section{acknowledgment}
This work is supported by the Rare Isotope Science Project funded by Ministry of Science, ICT and Future Planning\SEC{(MSIP)} and National Research Foundation\SEC{(NRF)} of Korea(Project No. 2011-0032011).

%
% this setting when the default (\flushend)
% => "balance two column" shows bad results
%
\iftrue   % balancing with bad results
%	\newpage
	\raggedend
\fi

\iffalse  % only for "biblatex"
%	\newpage
	\printbibliography

% "biblatex" is not used, go the "manual" way
\else

\begin{thebibliography}{9}   % Use for  1-9  references

%\bibitem{accelconf-ref}
%	C. Petit-Jean-Genaz and J. Poole,
%	``JACoW, A service to the Accelerator Community,''
%	EPAC'04, Lucerne, July 2004, THZCH03,  p.~249,
%	\url{http://www.JACoW.org/e04/papers/THZCH03.PDF}
\bibitem{TSHOO:NIMB} K.~Tshoo,{ et. al},``Experimental systems overview of the Rare Isotope Science Project in Korea'',

\bibitem{mrf}
	Micro-Research Finland Oy website:
	%\menu[,]{for Authors,Help,Using \LaTeX}
	\url{http://www.mrf.fi}%
%	last visit 27 March 2014.\newline \mbox{ }
	\hfill\textcolor{red}{\{no hyperlink, no period after URL\}}


\bibitem{xilix}
Xilinx-FPGA website:
%\menu[,]{for Authors,Help,Using \LaTeX}
\url{http://www.xilinx.com}
%	last visit 27 March 2014.\newline \mbox{ }

\bibitem{zynq}
Zynq-Book website:
%\menu[,]{for Authors,Help,Using \LaTeX}
\url{http://www.zynqbook.com}


\bibitem{amba-bus}
Advanced Microcontroller Bus Architecture website:
%\menu[,]{for Authors,Help,Using \LaTeX}
\url{http://https://en.wikipedia.org/wiki/Advanced_Microcontroller_Bus_Architecture}


\bibitem{analog}
Analog Devices website:
%\menu[,]{for Authors,Help,Using \LaTeX}
\url{http://www.analog.com}

\bibitem{zc706-doc}
ZC706 Evaluation Board Document:ug954-zc706-eval-board-xc7z045-ap-soc.pdf
%\menu[,]{for Authors,Help,Using \LaTeX}
\url{http://www.xilinx.com/support/documentation/boards_and_kits/zc706/ug954-zc706-eval-board-xc7z045-ap-soc.pdf}

\bibitem{linaro}
Linaro :
%\menu[,]{for Authors,Help,Using \LaTeX}
\url{https://en.wikipedia.org/wiki/Linaro}


\bibitem{exampl-ref}
	A.N. Other,
	``A Very Interesting Paper'',
	EPAC'96, Sitges, June 1996, MOPCH31 (1996),
	\url{http://www.JACoW.org}\newline \mbox{ } \hfill\textcolor{red}{\{no hyperlink, no period after URL\}}

\bibitem{exampl-ref2}
	F.E.~Black et al.,
	\textit{This is a Very Interesting Book},
	(New York: Knopf, 2007), 52.

\bibitem{exampl-ref3}
    G.B.~Smith et al., ``Title of Paper'',
    MOXAP07, \textit{These Proceedings}, IPAC'14, Dresden, Germany (2014).

	\hspace*{-1.1em}\mbox{\vdots}


\end{thebibliography}

\fi

\end{document}
