%\documentclass[11pt,a4paper]{article}
\documentclass[11pt
  , a4paper
  , article
  , oneside
%  , twoside
%  , draft
]{memoir}

\usepackage{control}
\usepackage[numbers]{natbib}
\definecolor{babypink}{rgb}{0.96, 0.76, 0.76}
\definecolor{blizzardblue}{rgb}{0.67, 0.9, 0.93}

\begin{document}

\newcommand{\technumber}{
  RAON Control-Document Series\\
  Revision : v1.0,   Release : Jan. 02. 2015}
\title{\textbf{SNMP 이해 및 응답시간 테스트}}

\author{박미정\thanks{mijoy0909@ibs.re.kr} \\

  Rare Isotope Science Project\\
  Institute for Basic Science, Daejeon, South Korea
}
\date{\today}

\renewcommand{\maketitlehooka}{\begin{flushright}\textsf{\technumber}\end{flushright}}
%\renewcommand{\maketitlehookb}{\centering\textsf{\subtitle}}
%\renewcommand{\maketitlehookc}{C}
%\renewcommand{\maketitlehookd}{D}

\maketitle

\begin{abstract}
SNMP는 IP 네트워크에서 장치를 관리하기 위한 공식 인터넷 표준 프로토콜(Official Internet Standards Protocol)\citep{oisp}이다. 본 문서는 SNMP의 이해, SNMP를 이용한 장비 모니터링 결과 그리고 다양한 네트워크 환경에서 SNMP 버전 별 응답시간에 관한 테스트 결과에 대해 설명한다. 
\end{abstract}

\chapter{SNMP의 이해}
\section{SNMP란?}

SNMP(Simple Network Management Protocol)는 IP네트워크 상의 장치 및 장비들을 관리하고 모니터링하기 위한 인터넷 표준 프로토콜이다. SNMP는 Manager와 Agent로 구성되어있으며, Manager는 NMS(Network Management Stations)로 표현되기도 한다. Manager는 Agent에게 원하는 장비의 정보를 요청하며, 장비의 설정을 변경한다. Agent는 Manager가 요청한 장비의 정보를 제공하고, 시스템 충돌이나 재부팅 등의 장비에 영향을 미치거나 발생한 Event를 비동기적으로 알리기 위해 Trap 메세지를 보낸다. 이들의 관계는 그림 \ref{fig:relationship_m_a}\citep{essential_snmp}과 같다. 이는 원래 NMS와 Agent의 관계이지만 본 문서에서는 Manager와 Agent의 관계로 재구성하였다.
\begin{figure}[h!]
  \centering
  \includegraphics[width=0.65\textwidth]{./images/relationship_m_a.eps}
  \caption{Manager와 Agent의 관계}
  \label{fig:relationship_m_a}   
\end{figure}

\hfil\break
\hfil\break
\hfil\break
\hfil\break

SNMP는 v1/2c/3의 세 가지 버전이 있으며, 각 버전들은 인증과 암호화에 따른 차이점이 있다. SNMPv1/2c는 Community string에 의존한 문자열 일치로 사용자 인증을 하지만 암호화 하지 않는다. 반면 v3는 username을 통힌 사용자 인증 및 암호화 알고리즘(MD5, SHA, DES, AES)을 통한 인증과 암호화에 따라 noAuthNoPriv, authNoPriv, authPriv의 세 종류의 보안 레벨로 나뉜다. v3는 v1/2c에 비해 보안이 강화되지만 응답시간이 큰 단점이 있다. 자세한 SNMP 버전 별 차이점은 표 \ref{table:conparision}\citep{comparison}을 참조바란다.

\begin{table}[h!]
\begin{center}
\begin{tabular}{c|c|c|c}\hline
Version & Level & Authentication & Encryption \\ \hline
v1 & noAuthNoPriv & Community string & No \\ \hline
v2c & noAuthNoPriv & Community string & No \\ \hline
 & noAuthNoPriv & Username & No \\ \cline{2-4}
v3 & authNoPriv & MD5 or SHA & No \\ \cline{2-4}
 & authPriv & MD5 or SHA & DES or AES \\ \hline
\end{tabular}
\caption{SNMP 버전 별 차이점}
  \label{table:conparision} 
\end{center}
\end{table} 

\clearpage
\section{MIB(Management Information Base)}
SNMP를 지원하는 장치들은 MIB를 가지고 있으며, MIB는 관리되어야 할 장비에 대한 객체들을 계층구조로 모아 놓은 것으로 관리의 편의를 위해 그림 \ref{fig:oid_tree}와 같이 ROOT-Node에서 시작해 branch node와 leaf node로 이뤄진 Tree 구조를 가진다. 일반적인 TCP/IP관리정보는 MIB-2(RFC 1213)에 포함돼 있고, 특정 장비 관련 정보는 장비제조업체에서 제공한다. 

\begin{figure}[h!]
  \centering
  \includegraphics[width=0.65\textwidth]{./images/oid_tree.eps}
  \caption{MIB의 일반적 구조}
  \label{fig:oid_tree} 
\end{figure}

MIB내의 객체들은 고유의 식별자를 가지며 이를 OID(Object Identifiers)라 한다. 그림 \ref{fig:oid_tree}를 참고하면 APC사의 OID는 세 종류의 표기법에 따라 1.3.6.1.4.1.318, iso.org.dod.internet.\\private.enterprises.apc, iso(1).org(3).dod(6).internet(1).private(4).enterprises(1).apc(318)로 표현된다. OID는 그림 \ref{fig:ex_mib}과 같은 포맷을 가지며 이를 통해 객체의 데이터 타입, 필요 유무, 정의 그리고 접근권한(read-only, read-write, etc...)에 대해 알 수 있다. 

\begin{figure}[h!]
  \centering
  \includegraphics[width=0.8\textwidth]{./images/ex_mib.eps}
  \caption{OID 포맷의 예}
  \label{fig:ex_mib}   
\end{figure}


\subsection{1.2.1 MIB 파일 설정}
사용하고자 하는 장비의 MIB파일을 .snmp/snmp.conf파일(그림 \ref{fig:snmp_conf})에 추가하면 복잡한 OID번호 대신 MIB파일 내 객체 이름을 사용하여 장비의 정보를 요청할 수 있다.
snmp.conf 파일에 추가하기 앞서 MIB파일의 DEFINITIONS에 정의된 이름과 파일의 이름이 다를 경우 약간의 수정이 필요하다. 
\begin{figure}[h]
  \centering
  \includegraphics[width=0.79\textwidth]{./images/snmp_conf.eps}
  \caption{snmp.conf 파일}
  \label{fig:snmp_conf}   
\end{figure}

그림 \ref{fig:pdu_mib}는 APC사 PDU의 MIB파일의 일부분으로 다음과 같이 MIB파일의 DEFINITIONS ::= BEGIN에 파일의 이름(PowerNet-MIB)을 정의해주고, MIB파일명도 동일하게(PowerNet-MIB) 저장하면 된다. 이 과정을 거치면 OID번호가 아닌 객체 이름으로 장비의 정보를 읽고 쓸 수 있다. 


\begin{figure}[h]
  \centering
  \includegraphics[width=0.79\textwidth]{./images/pdu_mib.eps}
  \caption{APC사 PDU의 MIB파일}
  \label{fig:pdu_mib}   
\end{figure}


\clearpage

\chapter{SNMP의 설치 및 사용}
\section{설치}
SNMP를 사용에 앞서 아래의 패키지를 설치해야 한다. 본 문서에서는 NET-SNMP\citep{net_snmp} v5.4.3을 사용하고 있다.
\begin{itemize}
\item NET-SNMP\footnote{* NET-SNMP는 http://www.net-snmp.org/download.html에서 다운받을 수 있다.}
\item snmp snmpd
\item snmp-mibs-downloader
\item libsnmp-dev libsnmp-base libsnmp-perl libsnmp15 
\end{itemize}


\section{SNMP 명령어와 사용}

\subsection{2.2.1 SNMPv3 설정}
SNMPv1/2c와 달리 SNMPv3는 보안레벨에 따른 인증과 암호화의 이유로 username, 알고리즘 그리고 패스워드 설정이 필요하다. 각 장비의 v3 관련 설정은 그림 \ref{fig:apc_v3}과 같이 장비제조업체에서 제공하는 웹 페이지, 프로그램, 시리얼 통신을 통해 설정할 수 있다. localhost의 SNMPv3 설정은 다음과 같이 net-snmp의 snmpd로 가능하다. 이때, 패스워드는 적어도 8자 이상이어야 한다.


\begin{figure}[h]
  \centering
  \includegraphics[width=0.79\textwidth]{./images/apcv3.eps}
  \caption{APC사의 장비설정 웹 페이지}
  \label{fig:apc_v3}   
\end{figure}




\begin{lstlisting}[style=termstyle]
mijoy0909@mjpark:~$ su                                     
root@mjpark:~# service snmpd stop
Stopping network management services: snmpd snmptrapd.
root@mjpark:~# net-snmp-config --create-snmpv3-user
Enter a SNMPv3 user name to create: 
mijoy
Enter authentication pass-phrase: 
[password]
Enter encryption pass-phrase: 
  [press return to reuse the authentication pass-phrase]
[password]
adding the following line to /var/lib/snmp/snmpd.conf:
   createUser test MD5 "[password]" DES [password]
adding the following line to /usr/share/snmp/snmpd.conf:
   rwuser mijoy 
root@mjpark:~# service snmpd start
Starting network management services: snmpd.
\end{lstlisting}

snmpd의 설정은 /usr/share/snmp/snmpd.conf에서 아래와 같이 확인 가능하다. \footnote{* http://www.net-snmp.org/docs/README.snmpv3.html 참조 바람}

\begin{lstlisting}[style=termstyle]
rwuser mijoy
\end{lstlisting}


\subsection{2.2.2 SNMP 명령어}
SNMP를 이용해 장비의 정보를 요청하기 위해서는 SNMP명령어\footnote{* 자세한 설명은 http://www.net-snmp.org/wiki/index.php/Tutorials를 참조 바람}가 사용되며, 명령어는 SNMP의 버전에 따라 차이가 있다.

\begin{itemize}
\item get : Manager가 Agent에게 특정 정보를 요청 시 사용
\item getnext : get과 동일, 동일 계층의 다음 정보를 요청 시 사용
\item walk : get의 확장 형태, Tree구조에서 하위 트리들의 정보를 요청 시 사용
\item set : Manager가 특정 값을 변경 및 설정 시 사용
\item trap : Agent가 비동기적 사건을 Manager에게 알리기 위해 사용
\item etc...
\end{itemize}

\clearpage

자주 사용되는 SNMP 옵션은 다음와 같다. 이 외의 추가적인 옵션은 snmp(walk, get, set, trap...) -h를 이용해 알 수 있다.

\begin{itemize}
\item -v 1/2c/3 : SNMP 버전
\item -c : v1/2c 사용자 (Community string)
\item -u : v3 사용자 (Username)
\item -a MD5/SHA : v3 authentication 암호화 알고리즘
\item -A : authentication 패스워드
\item -x DES/AES : v3 privacy 암호화 알고리즘
\item -X : privacy 패스워드
\item -m : 사용할 MIB파일
\item etc...
\end{itemize}


\subsection{2.2.3 SNMP 명령어 사용 1 (walk, get)}
\subsubsection{- SNMPv1/2c}

\begin{lstlisting}[style=termstyle]
snmp(walk, get) -v (v1/2c) -c (Community String) (HostAddress) (OID) 
\end{lstlisting}

v1/2c에서 사용자 인증에 사용하는 Community string은 대부분 public/privacy/admin 중 하나로 설정되어 장비제조업체에서 제공되지만, 사용자가 임의로 변경할 수 있다. public은 read-only 권한을 privacy, admin은 read-write의 권한을 가지고 있다. 따라서 public을 이용하여 장비의 정보 값을 변경할 수 없다. v1/2c는 Community string을 사용한 사용자 인증 외에는 특별한 보안이 없어 보안에 취약하다는 것을 알 수 있다. 
\begin{lstlisting}[style=termstyle]
mijoy0909@mjpark:~$ snmpwalk -v 1 -c public localhost
RFC1213-MIB::sysDescr.0 = STRING: "Linux mjpark 3.2.0-4-amd64 #1 SMP Debian 3.2.63-2+deb7u2 x86_64"
RFC1213-MIB::sysObjectID.0 = OID: SNMPv2-SMI::enterprises.8072.3.2.10
RFC1213-MIB::sysUpTime.0 = Timeticks: (49138) 0:08:11.38
RFC1213-MIB::sysContact.0 = STRING: "Me <me@example.org>"
RFC1213-MIB::sysName.0 = STRING: "mjpark"
.
.
.
real	0m1.440s
user	0m0.224s
sys	0m0.084s
--------------------------------------------------------------------------------------------------
mijoy0909@mjpark:~$ snmpwalk -v 2c -c public localhost
RFC1213-MIB::sysDescr.0 = STRING: "Linux mjpark 3.2.0-4-amd64 #1 SMP Debian 3.2.63-2+deb7u2 x86_64"
RFC1213-MIB::sysObjectID.0 = OID: SNMPv2-SMI::enterprises.8072.3.2.10
RFC1213-MIB::sysUpTime.0 = Timeticks: (49138) 0:08:11.38
RFC1213-MIB::sysContact.0 = STRING: "Me <me@example.org>"
RFC1213-MIB::sysName.0 = STRING: "mjpark"
.
.
.
real	0m1.422s
user	0m0.220s
sys	0m0.096s
\end{lstlisting}

위의 결과는 아래의 결과는 snmpwalk명령어로 요청한 localhost의 정보 일부와 linux time command를 이용해 요청의 응답에 걸린 시간을 측정한 결과이다. v1/2c는 버전의 차이 외에 사용의 차이가 없지만, Community string을 사용한 사용자 인증 외에 추가적인 보안이 없어 보안에 취약하다는 것을 알 수 있다.


장비의 모든 정보만 요청하는 snmpwalk와 달리 snmpget을 이용하면 아래와 같이 필요한 정보의 값을 선택적으로 읽을 수 있다.
\begin{lstlisting}[style=termstyle]
mijoy0909@mjpark:~$ snmpget -v 2c -c public localhost RFC1213-MIB::sysName.0
RFC1213-MIB::sysName.0 = STRING: "mjpark"
.
.

mijoy0909@mjpark:~$ snmpget -v 1 -c public localhost RFC1213-MIB::sysName.0 RFC1213-MIB::sysObjectID.0
RFC1213-MIB::sysName.0 = STRING: "mjpark"
RFC1213-MIB::sysObjectID.0 = OID: SNMPv2-SMI::enterprises.8072.3.2.10
\end{lstlisting}


\subsubsection{- SNMPv3}
v3는 v1/2c와 달리 Username을 사용하므로 –u옵션을 사용하고 암호화 알고리즘에 대한 옵션들이 추가되며, 기본 포맷은 다음과 같다.
\begin{lstlisting}[style=termstyle]
snmp(walk, get) -v 3 -u (Username) -l {Security Level(noAuthNoPriv/authNoPriv/authPrive)} -a {Authentication Protocol(MD5/SHA)} -A (PASSWORD) -x {Privacy Protocol(DES/AES)} -X (PASSWORD) (HostAddress) (OID) 
\end{lstlisting}

snmpwalk를 이용해 요청한 localhost의 정보 일부와 응답시간은 다음과 같다. v1/2c와 요청에 대한 응답의 차이는 없지만, 응답시간이 더 소요됨을 알 수 있다.

\begin{lstlisting}[style=termstyle]
mijoy0909@mjpark:~$ snmpwalk -v 3 -u mijoy -l authPriv -a MD5 -A  [PASSWORD]  -x DES -X  [PASSWORD]  localhost
RFC1213-MIB::sysDescr.0 = STRING: "Linux mjpark 3.2.0-4-amd64 #1 SMP Debian 3.2.63-2+deb7u2 x86_64"
RFC1213-MIB::sysObjectID.0 = OID: SNMPv2-SMI::enterprises.8072.3.2.10
RFC1213-MIB::sysUpTime.0 = Timeticks: (32928) 0:05:29.28
RFC1213-MIB::sysContact.0 = STRING: "Me <me@example.org>"
RFC1213-MIB::sysName.0 = STRING: "mjpark"
.
.
.
real	0m1.773s
user	0m0.340s
sys	0m0.124s
\end{lstlisting}


\subsection{2.2.4 SNMP 명령어 사용 2 (set)}

snmpwalk, get과 달리 set은 장비의 정보를 설정 및 변경하고자 할 때 사용된다. 이 때, 아래와 같이 객체가 가진 데이터 타입에 따른 옵션이 필요하다.

\begin{lstlisting}[style=termstyle]
 i: INTEGER 
 u: unsigned INTEGER 
 t: TIMETICKS
 a: IPADDRESS
 o: OBJID
 s: STRING
 x: HEX STRING
 d: DECIMAL STRING
 U: unsigned int64
 I: signed int64
 F: float
 D: double
\end{lstlisting}

버전별 snmpset명령어는 snmpwalk, get의 포맷에 데이터 타입과 값의 정보가 추가된 기본 포맷을 가진다.

\subsubsection{- SNMPv1/2c}

\begin{lstlisting}[style=termstyle]
mijoy0909@mjpark:~$ snmpset -v (v1/2c) -c (Community String) (HostAddress) (OID) (datatypes) (value)
\end{lstlisting}

\subsubsection{- SNMPv3}

\begin{lstlisting}[style=termstyle]
mijoy0909@mjpark:~$ snmpset -v 3 -u (Username) -l {Security Level(noAuthNoPriv/authNoPriv/authPrive)} -a {Authentication Protocol(MD5/SHA)} -A (PASSWORD) -x {Privacy Protocol(DES/AES)} -X (PASSWORD) (HostAddress) (OID) (datatypes) (value)
\end{lstlisting}

다음은 APC사의 Power Distribution Unit의 Outlet8번의 전원을 v3를 이용하여 설정한 결과이다. 

\begin{lstlisting}[style=termstyle]
mijoy0909@mjpark:~$ snmpset -v 3 -u mijoy -l authPriv -a MD5 -A [PASSWORD] -x DES -X [PASSWORD] 10.1.5.142 sPDUOutletCtl.8 i 2
PowerNet-MIB::sPDUOutletCtl.8 = INTEGER: outletOff(2)
.
.
mijoy0909@mjpark:~$ snmpset -v 3 -u mijoy -l authPriv -a MD5 -A [PASSWORD] -x DES -X [PASSWORD] 10.1.5.142 sPDUOutletCtl.7 i 1 sPDUOutletCtl.8 i 1
PowerNet-MIB::sPDUOutletCtl.7 = INTEGER: outletOn(1)
PowerNet-MIB::sPDUOutletCtl.8 = INTEGER: outletOn(1)
\end{lstlisting}

v1/2c에 비해 긴 v3의 명령어는 반복 사용에 어려움이 있다. 따라서 그림 \ref{fig:snmp_conf}와 같이 snmp.conf 파일에 장비의 v3에 대한 보안레벨, 암호화 알고리즘, 패스워드에 대한 정보를 미리 저장해둔다면 아래와 같이 간단한 명령어로 v3를 사용할 수 있다.\footnote{* 여러가지 장비의 정보를 설정한 후 장비의 정보를 요청한 결과 첫 번째로 저장된 설정에서만 간편하게 SNMPv3 사용이 가능하였다. 이는 추가적인 확인이 필요한데, 만약 첫 번째로 저장된 설정에서만 가능하다면 v3를 사용하고자 하는 장비의 보안레벨, 암호화 프로토콜, 그리고 패스워드를 통일하는 작업이 필요 할 것 같다.}

\begin{lstlisting}[style=termstyle]
mijoy0909@mjpark:~$ snmpget 10.1.5.142 sPDUIdentModelNumber
PowerNet-MIB::sPDUIdentModelNumber.0 = STRING: "AP7921"
\end{lstlisting}


\clearpage
\section{SNMP를 이용한 장비 모니터링}
본 문서에 사용된 시스템, 소프트웨어 및 하드웨어의 정보 그리고 장비제조업체에서 지원하는 SNMP버전\footnote{*본 문서에서 Read는 모니터링, Write는 제어라 칭한다.}은 다음과 같다.
\subsection{2.3.1 시스템 및 소프트웨어}
\begin{itemize}
\item Debian Linux 7 Wheezy
\item NET-SNMP v5.4.3
\item GNU Bash script-CLI(Command-line Interface) 
\end{itemize}

\subsection{2.3.2 하드웨어 및 SNMP지원버전\ref{table:used_version}}

\begin{table}[h]
\begin{center}
\begin{tabular}{c|c}\hline
Device Name & Supported Versions \\ \hline
Printer(Xerox, Kyocera) & v1* (R) \\ \hline
WIENER VME CRATE & v1/2c* (R/W) \\ \hline
ELMA VME CRATE & v3* (R) \\ \hline
APC PDU 7921 & v1/2c/3* (R/W) \\ \hline
\end{tabular}
\caption{모니터링에 사용된 장비와 장비 별 지원하는 SNMP 버전}
{(R: Read, W: Write / *: 모니터링에 사용된 버전)}
  \label{table:used_version}  
\end{center}
\end{table} 

\clearpage
\subsection{2.3.3 모니터링 결과}
\subsubsection{2.3.3.1 프린터(Xerox \& Kyocera)}

가속기 제어에 사용되는 장비에 앞서 Xerox사와 Kyocera사의 네트워크 프린터들에 기본 설정된 사항으로 프린터 용지의 종류와 양, 잉크의 잔여량 등의 상태 정보를 SNMPv1로 모니터링한 결과이다. 모니터링 결과에서 182 Printer는 Xerox사, 184 Printer는 Kyocera사의 프린터이다.

\begin{lstlisting}[style=termstyle, caption=Xerox \& Kyocera사 Printer 모니터링 결과]]
mijoy0909@mjpark:~/users/mijoy0909$ ./snmptest.sh 
 
Mon Nov 17 10:35:17 KST 2014
 
++++++++++++++++ Printer Status ++++++++++++++++
- 182 Printer              -, "Printing..." "" ""
- 184 Printer              -, "Sleeping " " "
 
++++++++ 182 Printer Paper Current Level ++++++++
- Tray1                    -, 25.000%
- Tray2                    -, 0%
- Tray3                    -, 75.000%
- Tray4                    -, 75.000%
- Tray5                    -, 0%
 
++++++++ 182 Printer Paper Current size ++++++++
- Tray1                    -, A4
- Tray2                    -, A4
- Tray3                    -, A4
- Tray4                    -, A3
- Tray5                    -, -
 
++++++++ 184 Printer Paper Current Level ++++++++
- MP Tray                  -, 0%
- Tray1                    -, 50.000%
- Tray2                    -, 0%
- Tray3                    -, 50.000%
- Tray4                    -, 50.000%
 
++++++++ 184 Printer Paper Current size ++++++++
- MP Tray                  -, A4
- Tray1                    -, A4
- Tray2                    -, -
- Tray3                    -, A3
- Tray4                    -, A3
 
++++++++ 182 Printer Toner Current Level ++++++++
- black                    -, 97.000%
- yellow                   -, 6.000%
- magenta                  -, 9.000%
- cyan                     -, 40.000%
 
++++++++ 184 Printer Toner Current Level ++++++++
- black                    -, 73.000%
 
+++++++++ 182 Printer Printed Page(s) ++++++++++
- total                    -, 477124
 
+++++++++ 184 Printer Printed Page(s) ++++++++++
- total                    -, 86618
\end{lstlisting}


\subsubsection{2.3.3.2 VMEbus Crate(Elma \& Wiener)}
VMEbus Crate(그림 \ref{fig:elmawiener})는 가속기를 제어하는 데 있어 중요한 장비들이며, 가속기 시설의 특성상 즉각적인 접근이 불가능한 지역에 설치되는 경우가 많다. 이러한 이유로 다른 장비들과 다르게 모니터링 및 제어를 할 수 있어야 하며, 신호의 보안에도 신경을 써야 한다.

\begin{figure}[h]
  \centering
  \includegraphics[width=0.7\textwidth]{./images/elmawiener.eps}
  \caption{Elma, Wiener Crate (위 : Elma, 아래: Wiener)}
  \label{fig:elmawiener}   
\end{figure}

\vspace{2mm}

본 문서에서 SNMPv3의 Read만 지원하는 Elma사의 Crate는 온도, 팬 스피드 등의 Crate 상태 모니터링 CLI를 구현하였고, SNMPv2c의 Read/Write를 모두 지원한 Wiener사의 Crate는 상태 모니터링뿐만 아니라 스위치의 전원과 팬 스피드를 제어할 수 있도록 구현되었다. 

\clearpage

- Elma Crate
\begin{lstlisting}[style=termstyle, caption=ELMA Crate 모니터링 결과]]
mijoy0909@mjpark:~/users/mijoy0909$ ./elma_test1.sh

- Voltage
==================================================
   #         Name          Value          State
==================================================
   1     "+3.3V"          3.290 V          OK
   2       "+5V"          4.980 V          OK
   3      "+12V"         11.960 V          OK
   4      "-12V"         12.090 V          OK
==================================================

- Temp
==================================================
   #         Name          Value          State
==================================================
   1       "Temp 1"       37 deg C         OK
   2       "Temp 2"       27 deg C         OK
   3       "Temp 3"       24 deg C         OK
==================================================

- Fan
==================================================
   #         Name          Value          State
==================================================
   1        "Fan 1"       3400 RPM         OK
   2        "Fan 2"       3400 RPM         OK
   3        "Fan 3"       3400 RPM         OK
   4        "Fan 4"       3400 RPM         OK
   5        "Fan 5"       3500 RPM         OK
   6        "Fan 6"       3400 RPM         OK
==================================================
\end{lstlisting}

\clearpage
- Wiener Crate
\begin{lstlisting}[style=termstyle, caption=Wiener Crate 모니터링 및 제어결과]]
***************************************
*               OPTIONS               *
***************************************
  [s] Status                           
  [1] Main Switch ON/OFF               
  [2] Change Fan Speed (1200~3600 RPM) 
  [q] Exit                             
  [0] Help                             
***************************************
-> Please enter your choice : 2

- Main Switch : ON
- Fan Speed : 3500 RPM
- Temperature Sensors1 : 25 deg C
- Temperature Sensors2 : 22 deg C

- Voltage
========================================
 Name        Value          State
========================================
  U0         3.33 V           On
  U1         5.01 V           On
  U2        12.06 V           On
  U3       -12.24 V           On
========================================

Enter Fan Speed (0~3600 RPM) : 
3600
INTEGER: 3600 RPM

- Main Switch : ON
- Fan Speed : 3600 RPM
- Temperature Sensors1 : 25 deg C
- Temperature Sensors2 : 22 deg C
\end{lstlisting}

\clearpage
\subsubsection{2.3.3.3 Power Distribution Unit}
VMEbus Crate와 마찬가지로 Power supply 또한 장비의 전원관리를 위해 모니터링과 제어를 할 수 있어야 한다. SNMPv3 Read/Write를 지원하는 APC사의 PDU (Power Distribution Unit) 7921(그림 \ref{fig:apc_pdu})을 이용하여 장비의 사용전력, 부하된 전류량 등의 상태를 모니터링 하고, 장비가 지원하는 다양한 옵션으로 Power Outlet을 제어할 수 있도록 하였다.
\begin{figure}[h]
  \centering
  \includegraphics[width=0.6\textwidth]{./images/apc_pdu.eps}
  \caption{APC PDU}
  \label{fig:apc_pdu}   
\end{figure}

\begin{lstlisting}[style=termstyle, caption=APC PDU 모니터링 및 제어결과]]
mijoy0909@mjpark:~/users/mijoy0909$ ./powernet_test8.sh

*****************************
*          OPTIONS          *
*****************************
  [s] Status                 
  [1] ON                     
  [2] OFF                    
  [3] Reboot                 
  [4] On with delay          
  [5] Off with delay         
  [6] Reboot with delay      
  [q] Exit                   
  [0] Help                   
*****************************
-> Please enter your choice : 2

------------------------------------------------------------
 PowerWatts                      , 220
 Load Status                     , 1.0 Amps

   #       Name       Status      Control Outlet Command
============================================================
   1     "Outlet 1"      On              immediateOn
   2     "Outlet 2"      On              immediateOn
   3     "Outlet 3"      On              immediateOn
   4     "Outlet 4"      On              immediateOn
   5     "Outlet 5"      On              immediateOn
   6     "Outlet 6"      On              immediateOn
   7     "Outlet 7"      On              immediateOn
   8     "Outlet 8"      On              immediateOn
============================================================
------------------------------------------------------------
  [s] Status                 
  [1] Outlet1                
  [2] Outlet2                
  [3] Outlet3                
  [4] Outlet4                
  [5] Outlet5                
  [6] Outlet6                
  [7] Outlet7                
  [8] Outlet8                
  [b] Back                   
  [q] Exit                   
  [0] Help                   
-> Select outlet: 8
-> Are you sure? [y/n]y
outletOff

------------------------------------------------------------
 PowerWatts                      , 220
 Load Status                     , 1.0 Amps

   #       Name       Status      Control Outlet Command
============================================================
   1     "Outlet 1"      On              immediateOn
   2     "Outlet 2"      On              immediateOn
   3     "Outlet 3"      On              immediateOn
   4     "Outlet 4"      On              immediateOn
   5     "Outlet 5"      On              immediateOn
   6     "Outlet 6"      On              immediateOn
   7     "Outlet 7"      On              immediateOn
   8     "Outlet 8"     Off             immediateOff
============================================================
------------------------------------------------------------
\end{lstlisting}


\clearpage

\chapter{SNMP 버전 별 응답시간 실험}
실험 당시 SNMP의 모든 버전을 지원한 APC PDU 7921을 사용하여 스위치 개수와 케이블 길이에 따라 모니터링과 제어에 걸리는 SNMP 버전 별 응답시간 실험에 대해 논한다. SNMP 응답시간에 대한 정보가 부족해 실험에 앞서 v3에서의 암호화 및 복호화에 걸리는 시간, 케이블 딜레이, 하드웨어 자체의 속도 및 사용된 Linux OS에 대한 응답시간의 차이가 같다는 가정하에 같은 케이블 길이에서 snmpwalk 명령어를 이용해 장비의 정보를 요청하는 선행실험을 수행하였다. 표 \ref{table:test}는 SNMP 버전 별 요청에 따른 응답시간으로 SNMPv1/2c는 서로 비교할 수 없는 오차 범위에 있으며, v3는 타 버전보다 1.5배 정도의 시간이 더 소모됨을 알 수 있다. 

\begin{table}[h!]
\begin{center}
\begin{tabular}{c|c|c|c|c}\hline
 & v1 & v2c & v3(R) & v3(W) \\ \hline
mean & 2.863 & 2.852 & 4.101 & 4.138 \\ \hline
sample deviation & 0.867 & 0.840 & 0.814 & 0.864 \\ \hline
\end{tabular}
\caption{SNMP 버전에 따른 응답시간(wall-clock time response)의 차이 (단위: ms)}
  \label{table:test}  
\end{center}
\end{table}
이 결과 SNMPv1/2c는 서로 비교할 수 없는 오차 범위에 있으며, v3는 타 버전보다 1.5배 정도의 시간이 더 소모됨을 확인할 수 있었다.

\section{실험 목적}
가속기 시설의 복잡성, 장비의 다양성 그리고 안전한 장비 접근성을 만족하며, 동시에 장비의 안정된 응답시간을 보장하는 장비의 설치 위치를 선정하는 것은 어려운 일이다. 선행실험을 통해 SNMP가 네트워크 보안 정도에 따라 1.5배의 차이가 있음을 알 수 있었고, 이에 제어 네트워크 토폴로지 설계 및 응답시간 최적화 설계가 필요하다. 가속기 제어 네트워크 토폴로지 설계에 필요한 물리적인 구성요소는 Layer 2 스위치와 UTP 케이블의 길이이므로 이러한 요소들이 가능한 토폴로지의 구성, 이상적인 장비의 응답시간과 구성요소 간의 상관관계 측정이 요구된다. 따라서 실험을 통해 얻게 되는 결과들은 네트워크 토폴로지 설계 및 장비의 최적화된 설치위치 선정에 도움이 될 것이다.

\section{실험 방법}
본 실험에서는 프로그램이 수행되는 시간을 측정하는 리눅스의 time 명령어를 이용하여 Bash Shell Script 수행에 걸리는 시간을 응답시간으로 측정하였다. time 명령어는 아래와 같이 세 가지 형태의 시간 측정 결과를 나타낸다\citep{time_command}. 
\begin{itemize}
\item real : 실제로 걸린 시간
\item user : 커널이 사용한 시간을 제외한 CPU에서 소비된 시간
\item sys : 실제로 할애한 커널 시간
\end{itemize}
이를 참조하면 user+sys의 시간은 실제로 작업에 할애된 시간이며, real-(user+sys)의 시간은 다른 프로세서 처리에 할당된 시간이다. 따라서 본 실험에서는 Layer 2 스위치 간의 내부 시간 차이와 케이블을 제작 시 발생하는 길이의 오차 등에서 발생하는 시간이 포함된 실제 작업 시간인 user+sys시간을 사용한다. UTP 케이블이 물리적으로 신호를 안정적으로 전달할 수 있는 최대 길이가 100m인 점을 고려하여 본 실험에는 1m, 10m, 20m, 30m, 40m, 50m, 100m 길이의 CAT6 LAN 케이블을 사용한다. 

\subsection{3.2.1 시스템 및 소프트웨어}
실험에 사용된 시스템, 소프트웨어, 그리고 하드웨어는 아래와 같다.

\begin{itemize}
\item Debian Linux 7 Wheezy
\item NET-SNMP v5.4.3
\item R v2.15.1
\item GNU Bash Script-CLI(Command-line Interface) 
\item Switch(BROCADE ICX6430)
\item Power Distribution Unit(APC PDU 7921)
\end{itemize}

\subsection{3.2.2 Bash Script 구성}
본 문서의 SNMPv1/2c/3의 응답시간 측정에는 GNU Bash Shell을 이용하여 만든 Script를 사용한다. 이 Script는 v1/2c일 경우 snmpget 명령어로 PDU Outlet 8번의 상태 정보를 1,000번 요청하고, v3의 경우 상태 정보 요청뿐만 아니라 snmpset 명령어로 Outlet 8번의 전원을 켜는 명령어 1,000번 수행하도록 구성되었다. 구성된 Script는 리눅스 Sleep 명령어를 사용해 1초 멈추는 조건과 그렇지 않은 조건으로 나뉘어 수행되고 time 명령어를 사용해 이 이 과정에 든 시간을 측정한다. 측정결과는 계산되어 CLI에 total count, mean, sample deviation, standard deviation으로 표현된다.

\begin{figure}[!htb]
  \centering
  \includegraphics[width=0.6\textwidth]{./images/switch5.eps}
  \caption{Bash Script }
  \label{fig:switch}   
\end{figure}


\begin{lstlisting}[style=termstyle, caption=GNU Bash script를 통한 CLI]
mijoy0909@mjpark:~/speedtest$ ./speedtest.sh 

**********************************
*               OPTIONS          *
**********************************
  [1] SNMP Speed Test             
  [2] File Merge                  
  [3] R(Linear)                   
  [4] R(Histogram)                
----------------------------------
----------------------------------
  [5] Edit R(linear)              
  [6] Edit R(histogram)           
----------------------------------
----------------------------------
  [q] Exit                        
  [0] Help                        
**********************************
-> Select sub option: 1

****************************************
*              SUB OPTIONS             *
****************************************
  [1] SNMP v1        / sleep x          
  [2] SNMP v1        / sleep 1          
  [3] SNMP v2c       / sleep x          
  [4] SNMP v2c       / sleep 1          
  [5] SNMP v3(read)  / sleep x          
  [6] SNMP v3(read)  / sleep 1          
  [7] SNMP v3(write) / sleep x          
  [8] SNMP v3(write) / sleep 1          
  [b] Back                              
  [q] Exit                              
  [0] Help                              
***************************************
-> Select sub option: 1

Enter name you wish to save [ex.example] :S1V1SXC1
/home/mijoy0909/speedtest
outletOn
outletOn
.
outletOn
-----------------------------------------------
<real>

Total count        :       1000
Mean               : 0.09147000
Sample Deviation   : 0.00503631
Standard Deviation : 0.00503380

-----------------------------------------------
<user>

Total count        :       1000
Mean               : 0.06384000
Sample Deviation   : 0.00590672
Standard Deviation : 0.00590376

-----------------------------------------------
<sys>

Total count        :       1000
Mean               : 0.00061000
Sample Deviation   : 0.00247670
Standard Deviation : 0.00247546

***********************************************

Mean(user+sys)             : 0.03222500
Sample Deviation(user+sys) : 0.00640495

***********************************************
-----------------------------------------------
\end{lstlisting}

\subsection{3.2.3 실험 배치도 및 방법}

실험은 \ref{fig:switch}의 배치도와 같이 구성하여 케이블 길이와 스위치 개수를 변경하면서 Bash Script의 실행으로 진행된다. 

1. 컴퓨터와 스위치를 측정하고자 하는 길이의 케이블로 연결한다.
2. Bash Script에서 응답시간 측정 옵션을 선택한다.
3. 실험환경에 따라 옵션을 선택한 후 log 파일의 이름을 정의한다.
4. 1~3의 과정을 1, 50, 100m의 케이블과 스위치 개수를 변경하면서 반복 수행한다. 이때 컴퓨터는 첫 번째 스위치 계속 연결되어있고, PDU는 추가되는 스위치에 연결한다. 
5. Script의 File Merge 옵션으로 ASCII 파일로 저장된 응답시간의 mean 값 데이터를 테이블로 재구성한다. <그림 \ref{fig:time_table}>
6. R\citep{r}로 10, 20, 30, 40m 케이블 길이에서의 응답시간을 예측한다.
7. 1~5 과정을 반복해 예측된 값과 실제 측정한 값을 비교하고 회귀분석을 통해 가설을 검증한다.

\begin{figure}[!htb]
  \centering
  \includegraphics[width=0.6\textwidth]{./images/switch5.eps}
  \caption{테스트 배치}
  \label{fig:switch}   
\end{figure}


\begin{figure}[!htb]
  \centering
  \includegraphics[width=0.8\textwidth]{./images/timetable.eps}
  \caption{데이터 테이블}
  \label{fig:time_table}   
\end{figure}

\clearpage
\section{실험 결과}
\subsection{3.3.1 케이블 길이와 응답시간의 관계}
본 실험은 케이블 길이가 응답시간에 영향을 미칠 것이라 가설을 세웠고, 두 변수 간의 관련성이 연구할 만한 자료인지 판단하기 위해 통계 계산과 그래픽을 위한 프로그래밍 언어이자 소프트웨어 환경인 R로 linear fitting을 통한 linear그래프와 산점도를 그려 변수들의 상관관계를 확인하였다. 그림 \ref{fig:linear}은 스위치의 개수와 케이블 길이에 대한 SNMP 버전 별 응답시간이다. 대부분 그래프에서 케이블의 길이가 길어질수록 응답시간이 큰 것을 알 수 있다.

\begin{figure}[!htb]
  \centering
  \includegraphics[width=0.9\textwidth]{./images/sleep1_switch.eps}
  \caption{산점도와 linear 그래프}
  \label{fig:linear}   
\end{figure}

\clearpage

\subsection{3.3.2 R을 통한 데이터 분석 및 예측}
데이터 분석에는 하나 또는 그 이상의 독립변수(x)의 종속변수(y)에 대한 영향의 추정을 할 수 있는 통계기법인 회귀분석을 사용한다. 회귀분석은 최소 하나 이상의 독립변수의 값에 근거하여 종속변수의 값을 예측하거나 독립변수가 종속변수에 미치는 영향력의 크기를 설명하는 데 유용하다. 회귀분석에서 독립변수는 다른 변수에 영향을 미치는 변수이고, 종속변수는 독립변수에 의해 영향을 받는 변수이다. 본 실험에서의 독립변수는 케이블 길이이고, 종속변수는 응답시간이다. 종속변수가 독립변수에 어떻게 관련되어 있는가를 나타내는 방정식은 회귀모델이며, 실험의 회귀모델은 식\ref{eq:eps}과 같다. 
\begin{equation} \label{eq:eps}
  y=\alpha + \beta x 
\end{equation}

그림 \ref{fig:s3s1}은 스위치를 세 개 연결하고, 1초 Sleep 시 SNMPv2c와 v3w의 단순회귀분석그래프이다.  

\begin{figure}[!htb]
  \centering
  \includegraphics[width=0.88\textwidth]{./images/s3s1.eps}
  \caption{회귀분석 그래프(스위치 3개/Sleep1)}
  \label{fig:s3s1}   
\end{figure}

이 그래프에서 confidence limit(녹색 점선)은 추가적인 실험 진행 시 1, 10, 20, 30, 40, 50, 100m의 케이블 길이에서 나올 수 있는 응답시간의 범위를 나타내고, prediction limit(청색 점선)은 실험에 사용된 케이블 길이가 아닌 길이의 케이블을 사용하여 응답시간 측정 시에 나올 수 있는 응답시간의 범위이다. ●는 1, 10, 20, 30, 40, 50, 100m의 케이블 길이에서 측정한 결괏값이며, ▲는 1, 50, 100m 길이로 측정한 결괏값으로 linear fitting 피팅을 통해 10, 20, 30, 40m의 길이에서 응답시간을 예측한 값이다. 

\begin{table}[!htb]
\begin{center}
\begin{tabular}{c|c|c|c|c}\hline
길이(m) & 10 & 20 & 30 & 40 \\ \hline
예측응답시간(ms)& 35.50 & 35.56 & 35.63 & 35.69 \\ \hline
실제응답시간(ms)& 35.45 & 35.32 & 35.75 & 36.02 \\ \hline
\end{tabular}
\caption{케이블 길이에 따른 응답시간의 예측과 측정(v3w)}
  \label{table:predict_time}  
\end{center}
\end{table} 
표 \ref{table:predict_time}은 그림 \ref{fig:s3s1}에서 v3w부분을 표식 화한 것으로, 실험 결과 예측된 응답시간과 실제 측정한 응답시간이 ±1ms의 오차범위 내에 있는 것을 확인할 수 있다.

 \subsection{3.3.3 회귀분석 결과와 가설 검증}
 실험 전 세운 가설의 타당성을 입증하기 위하여 회귀분석을 수행하였고 표 \ref{table:regression}는 v3w에서의 회귀분석 결과이다.
 
\begin{table}[!htb]
\begin{center}
\begin{tabular}{c|c}\hline
Independent variable & Value  \\ \hline\hline
p-value &  0.0155\\ 
F-value &  13\\ 
$  R^2  $ &  0.722\\ 
$ Adjusted R^2 $ & 0.666 \\ \hline
\multicolumn{2}{l}{*p ＜ 0.05} \\ \hline\hline
\end{tabular}
\caption{회귀분석결과(v3w)}
  \label{table:regression}  
\end{center}
\end{table} 
회귀분석에서 $  R^2  $은 종속변수의 총 변동에서 독립변수의 변동으로 설명되는 부분이 차지하는 비중을 의미한다. 스위치가 3개 연결되었을 때, v3w의 경우 응답시간 변동의 약 72.2\%를 케이블 길이 변동으로 설명할 수 있다. 또한, p-value가 0.0155로 α인 0.05보다 작으므로 앞서 세운 가설이 통계적으로 유의하다고 할 수 있다. 하지만 대부분의 실험 결과에서 특정 케이블 길이에서 예측된 응답시간과 실제 측정된 응답시간은 오차범위 내에 속했지만, 가설은 통계적으로 유의하지 않았다. 이는 분석에 사용된 샘플링의 수의 부족, 사용된 케이블 길이 간 오차, 하드웨어 자체의 속도 등의 테스트 환경이 완벽하게 같지 않아 정밀한 실험이 불가능했다는 점을 이유로 꼽을 수 있다. 따라서 샘플링의 수를 증가시키고 실험 환경을 보완한 후, APC사의 PDU와 현재 SNMP 세 가지 버전을 지원하는 다른 장비를 사용하여 추가적인 응답시간 실험이 필요할 것으로 보인다. 

\clearpage
\appendix
\addappheadtotoc
\renewcommand*\printchaptername{\Large\bfseries\appendixname~}
\chapter{회귀분석 그래프}

\section{Switch 1}
 \begin{figure}[!htb]
  \centering
  \includegraphics[width=0.55\textwidth]{./images/s1sx.eps}
  \includegraphics[width=0.55\textwidth]{./images/s1s1.eps}
  \caption{Swtich1 configuration}
\end{figure}
\clearpage

\section{Switch 2}
 \begin{figure}[!htb]
  \centering
  \includegraphics[width=0.55\textwidth]{./images/s2sx.eps}
  \includegraphics[width=0.55\textwidth]{./images/s2s1.eps}
  \caption{Swtich2 configuration}
\end{figure}
\clearpage

\section{Switch 3}
 \begin{figure}[!htb]
  \centering
  \includegraphics[width=0.55\textwidth]{./images/s3sx.eps}
  \includegraphics[width=0.55\textwidth]{./images/s3s1.eps}
  \caption{Swtich3 configuration}
\end{figure}
\clearpage

\section{Switch 4}
 \begin{figure}[!htb]
  \centering
  \includegraphics[width=0.55\textwidth]{./images/s4sx.eps}
  \includegraphics[width=0.55\textwidth]{./images/s4s1.eps}
  \caption{Swtich4 configuration}
\end{figure}
\clearpage

\section{Switch 5}
 \begin{figure}[!htb]
  \centering
  \includegraphics[width=0.55\textwidth]{./images/s5sx.eps}
  \includegraphics[width=0.55\textwidth]{./images/s5s1.eps}
  \caption{Swtich4 configuration} 
\end{figure}

\chapter{회귀분석 결과}\label{cha:result}
\section{Switch 1}

\begin{table}[h!]
\begin{center}
\begin{tabular}{c|c||c||c||c}
\multicolumn{5}{c}{Switch1/Sleepx}\\ \hline\hline
\multicolumn{1}{c|}{}& \multicolumn{4}{c}{Value}\\
\cline{1-5}
Independent variable & v1 & v2c & v3r & v3w      \\ \hline\hline
p-value &  0.164 &  0.166 & 0.105  &  0.111\\ 
F-value &  2.65 &  2.63&  3.9 &  3.73\\ 
$  R^2  $ &  0.347  &  0.344&  0.438 &  0.427\\ 
Adjusted $  R^2  $ & 0.0216 & 0.213 & 0.326 & 0.313\\ \hline\hline
\multicolumn{5}{r}{*p ＜ 0.05} \\
\multicolumn{5}{c}{Switch1/Sleep1}\\ \hline\hline
\multicolumn{1}{c|}{}& \multicolumn{4}{c}{Value}\\
\cline{1-5}
Independent variable & v1 & v2c & v3r & v3w     \\ \hline\hline
p-value &  0.0802 &  0.0176& 0.464 &  0.231\\ 
F-value &  4.79  &  12.1&  0.628 &  1.86\\ 
$  R^2  $ &  0.489 &  0.708 &  0.112  &  0.271\\ 
Adjusted $  R^2  $ & 0.387 & 0.65 & -0.0661 & 0.125\\ \hline\hline
\multicolumn{5}{r}{*p ＜ 0.05} 
\end{tabular}
\caption{Switch1 Regression Analysis Result }
\end{center}
\end{table} 
\clearpage

\section{Switch 2}
\begin{table}[h!]
\begin{center}
\begin{tabular}{c|c||c||c||c}
\multicolumn{5}{c}{Switch2/Sleepx}\\ \hline\hline
\multicolumn{1}{c|}{}& \multicolumn{4}{c}{Value}\\
\cline{1-5}
Independent variable & v1 & v2c & v3r & v3w      \\ \hline\hline
p-value & 0.293 & 0.508 & 0.263 & 0.272\\ 
F-value & 1.38 & 0.507 & 1.59 & 1.52\\ 
$  R^2  $ & 0.217 & 0.092 & 0.242 & 0.233\\ 
Adjusted $  R^2  $ & 0.0598 & -0.0896 & 0.09 & 0.0799\\ \hline\hline
\multicolumn{5}{r}{*p ＜ 0.05} \\ 
\multicolumn{5}{c}{Switch2/Sleep1}\\ \hline\hline
\multicolumn{1}{c|}{}& \multicolumn{4}{c}{Value}\\
\cline{1-5}
Independent variable & v1 & v2c & v3r & v3w      \\ \hline\hline
p-value &  0.294 &  0.179& 0.235  &  0.335\\ 
F-value &  1.38 &  2.22 &  1.82  &  1.14\\ 
$  R^2  $ &  0.216 &  0.307&  0.267 & 0.185\\ 
Adjusted $  R^2  $ & 0.059 & 0.169 & 0.121 & 0.0224\\ \hline\hline
\multicolumn{5}{r}{*p ＜ 0.05} \\ 
\end{tabular}
\caption{Switch1 Regression Analysis Result }
\end{center}
\end{table} 
\clearpage

\section{Switch 3}
\begin{table}[h!]
\begin{center}
\begin{tabular}{c|c||c||c||c}
\multicolumn{5}{c}{Switch3/Sleepx}\\ \hline\hline
\multicolumn{1}{c|}{}& \multicolumn{4}{c}{Value}\\
\cline{1-5}
Independent variable & v1 & v2c & v3r & v3w      \\ \hline\hline
p-value & 0.336 & 0.563 & 0.115 & 0.158\\ 
F-value & 1.13  & 0.383 & 3.62 & 2.75\\ 
$  R^2  $ & 0.184 & 0.0711 & 0.42 & 0.355\\ 
Adjusted $  R^2  $ & 0.0211 & -0.115 & 0.304 & 0.225\\ \hline\hline
\multicolumn{5}{r}{*p ＜ 0.05} \\ 
\multicolumn{5}{c}{Switch3/Sleep1}\\ \hline\hline
\multicolumn{1}{c|}{}& \multicolumn{4}{c}{Value}\\
\cline{1-5}
Independent variable & v1 & v2c & v3r & v3w      \\ \hline\hline
p-value & 0.154 & 0.243 & 0.33 & 0.0155\\ 
F-value & 2.82 & 1.75 & 1.16 & 13\\ 
$  R^2  $ & 0.361 & 0.259 & 0.189 & 0.722\\ 
Adjusted $  R^2  $ & 0.233  & 0.111& 0.0262 & 0.666\\ \hline\hline
\multicolumn{5}{r}{*p ＜ 0.05} \\ 
\end{tabular}
\caption{Switch3 Regression Analysis Result }
\end{center}
\end{table} 
\clearpage

\section{Switch 4}
\begin{table}[h!]
\begin{center}
\begin{tabular}{c|c||c||c||c}
\multicolumn{5}{c}{Switch4/Sleepx}\\ \hline\hline
\multicolumn{1}{c|}{}& \multicolumn{4}{c}{Value}\\
\cline{1-5}
Independent variable & v1 & v2c & v3r & v3w      \\ \hline\hline
p-value &  0.409 & 0.36 & 0.419 & 0.374\\ 
F-value &  0.813 & 1.01 & 0.775 & 0.954\\ 
$  R^2  $ & 0.14 & 0.169 & 0.134 & 0.16\\ 
Adjusted $  R^2  $ & -0.0322 & 0.00245 & -0.039 & -0.00774\\ \hline\hline
\multicolumn{5}{r}{*p ＜ 0.05} \\
\multicolumn{5}{c}{Switch4/Sleep1}\\ \hline\hline
\multicolumn{1}{c|}{}& \multicolumn{4}{c}{Value}\\
\cline{1-5}
Independent variable & v1 & v2c & v3r & v3w      \\ \hline\hline
p-value & 0.000107 & 0.168 & 0.112 & 0.19\\ 
F-value & 122 &  2.59&  3.7  &  2.3\\ 
$  R^2  $ & 0.961 & 0.342& 0.426 & 0.315\\ 
Adjusted $  R^2  $ & 0.953 & 0.21& 0.311 & 0.178\\ \hline\hline
\multicolumn{5}{r}{*p ＜ 0.05} \\ 
\end{tabular}
\caption{Switch4 Regression Analysis Result }
\end{center}
\end{table} 
\clearpage

\section{Switch 5}
\begin{table}[h!]
\begin{center}
\begin{tabular}{c|c||c||c||c}
\multicolumn{5}{c}{Switch5/Sleepx}\\ \hline\hline
\multicolumn{1}{c|}{}& \multicolumn{4}{c}{Value}\\
\cline{1-5}
Independent variable & v1 & v2c & v3r & v3w      \\ \hline\hline
p-value & 0.616 & 0.405& 0.159 & 0.242\\ 
F-value & 0.285 & 0.828& 2.74 & 1.76\\ 
$  R^2  $ & 0.054 & 0.142& 0.354 & 0.26\\ 
Adjusted $  R^2  $ & -0.135 & -0.0295& 0.224 & 0.112\\ \hline\hline
\multicolumn{5}{r}{*p ＜ 0.05} \\ 
\multicolumn{5}{c}{Switch5/Sleep1}\\ \hline\hline
\multicolumn{1}{c|}{}& \multicolumn{4}{c}{Value}\\
\cline{1-5}
Independent variable & v1 & v2c & v3r & v3w      \\ \hline\hline
p-value & 0.751 & 0.768 & 0.595 & 0.28\\ 
F-value & 0.113 & 0.0968 & 0.323 & 1.47\\ 
$  R^2  $ & 0.022 & 0.019& 0.0606 & 0.227\\ 
Adjusted $  R^2  $ & -0.174 & -0.177 & -0.127 & 0.072\\ \hline\hline
\multicolumn{5}{r}{*p ＜ 0.05} \\ 
\end{tabular}
\caption{Switch1 Regression Analysis Result }
\end{center}
\end{table} 



\clearpage
\bibliographystyle{unsrtnat}
\bibliography{./refs}

\end{document}

